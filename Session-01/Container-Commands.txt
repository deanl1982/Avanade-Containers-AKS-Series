# 1. Use "docker build" to compile a new image from the dockerfile

docker build -t hobbitappfe .

# 2. Create container from image 

docker run -d -p 80:80 hobbitappfe

# 3. Login to Azure CLI

az login --tenant 2412cacc-5700-4d65-9698-4b9a510638fb
az acr login --name hobbitfeetcontainers

# 4. Tag and push container image to ACR

docker tag hobbitappfe hobbitfeetcontainers.azurecr.io/hobbitappfe-feb24:v2
docker push hobbitfeetcontainers.azurecr.io/hobbitappfe-feb24:v2

#5. Connect to AKS

az aks get-credentials --resource-group UKS-AKS-AVA --name hob-aks-ava

# 6. Prepare K8S Manifest

kubectl apply -f hobbitappfe.yml
kubectl get deployments
kubectl get deployments --all-namespaces
kubectl get pods --all-namespaces
kubectl get nodes

kubectl apply -f hobbitappfe-service.yml
kubectl get services

kubectl delete pod hobbitappfe
kubectl delete pod -l app=hobbitappfe
kubectl delete service hobbitappfe-service

kubectl delete deployment mywebserverapp
